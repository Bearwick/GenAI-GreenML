# Generated by generate_llm_code.py
# LLM: codex
# Mode: autonomous

import os
import pandas as pd
import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.pipeline import Pipeline
from sklearn.preprocessing import StandardScaler
from sklearn.impute import SimpleImputer
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score

def find_dataset():
    candidates = []
    for root, _, files in os.walk("."):
        for f in files:
            if f.lower().endswith(".csv"):
                candidates.append(os.path.join(root, f))
    for path in sorted(candidates):
        try:
            df_head = pd.read_csv(path, nrows=1)
        except Exception:
            continue
        cols = {c.strip() for c in df_head.columns}
        if "diagnosis" in cols:
            return path
    raise FileNotFoundError("Dataset CSV not found.")

dataset_path = find_dataset()
df = pd.read_csv(dataset_path)
df.columns = df.columns.str.strip()
if "Unnamed: 32" in df.columns:
    df = df.drop(columns=["Unnamed: 32"])
if "id" in df.columns:
    df = df.drop(columns=["id"])

target = df["diagnosis"]
X = df.drop(columns=["diagnosis"])
X = X.select_dtypes(include=[np.number])

if target.dtype == object or str(target.dtype).startswith("category"):
    mapping = {"M": 1, "B": 0}
    y_mapped = target.map(mapping)
    if y_mapped.isnull().any():
        y = pd.factorize(target)[0]
    else:
        y = y_mapped.values
else:
    y = target.values

stratify = y if len(np.unique(y)) > 1 else None
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42, stratify=stratify
)

model = Pipeline(
    steps=[
        ("imputer", SimpleImputer(strategy="median")),
        ("scaler", StandardScaler()),
        ("clf", LogisticRegression(max_iter=1000, solver="liblinear")),
    ]
)

model.fit(X_train, y_train)
y_pred = model.predict(X_test)
accuracy = accuracy_score(y_test, y_pred)
print(f"ACCURACY={accuracy:.6f}")

# OPTIMIZATION SUMMARY
# Used logistic regression with standard scaling for a lightweight linear model suitable for small datasets.
# Median imputation provides simple, low-cost handling of missing values without complex preprocessing.
# Pipeline ensures efficient CPU execution and reproducible preprocessing steps.