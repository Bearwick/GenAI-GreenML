# Generated by generate_llm_code.py
# LLM: chatgpt
# Mode: original_telemetry

import numpy as np
from scipy.spatial.distance import cdist

file_name = "iris.csv"

data = np.loadtxt(file_name, delimiter=",", dtype="object")
column_names = data[0]
data = data[1:]

features = data[:, :-1].astype(float)

labels = data[:, -1]
labels[labels == "setosa"] = 0
labels[labels == "versicolor"] = 1
labels[labels == "virginica"] = 2
labels = labels.astype(float)

features = data[:, 2:4].astype(float)

centroids = np.zeros((3, 2))
for i in range(3):
    centroids[i] = features[labels == i].mean(axis=0)

sample = np.array([3.1, 1.2]).reshape(1, 2)
distance = cdist(sample, centroids, metric="euclidean")
predicted_classes = np.argmin(distance)

distances = cdist(features, centroids, metric="euclidean")
y_pred = np.argmin(distances, axis=1)
y_true = labels.astype(int)

accuracy = np.mean(y_pred == y_true)
print(f"ACCURACY={accuracy:.6f}")