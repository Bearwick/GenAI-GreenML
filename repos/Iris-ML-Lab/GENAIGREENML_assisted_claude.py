# Generated by generate_llm_code.py
# LLM: claude
# Mode: assisted

import numpy as np
from scipy.spatial.distance import cdist

data = np.loadtxt('iris.csv', delimiter=',', dtype='object')
data = data[1:]

labels_str = data[:, -1]
label_map = {'setosa': 0, 'versicolor': 1, 'virginica': 2}
labels = np.array([label_map[l] for l in labels_str], dtype=int)

features = data[:, 2:4].astype(float)

centroids = np.zeros((3, 2))
for i in range(3):
    centroids[i] = features[labels == i].mean(axis=0)

distances = cdist(features, centroids, metric='euclidean')
y_pred = np.argmin(distances, axis=1)

accuracy = np.mean(y_pred == labels)
print(f"ACCURACY={accuracy:.6f}")

# OPTIMIZATION SUMMARY
# Removed matplotlib imports and all plotting/saving to eliminate unnecessary computation and I/O.
# Removed all print statements except the required accuracy print.
# Removed interactive input and model saving.
# Only load columns needed (petal_length, petal_width) for the nearest-centroid classifier.
# Used a dictionary for label mapping instead of repeated array boolean assignment.
# Labels stored as int directly, avoiding intermediate float conversion.
# Single cdist call for all samples to centroids, avoiding redundant computation.
# Minimal memory footprint: only necessary arrays are created.