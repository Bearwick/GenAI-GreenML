# Generated by generate_llm_code.py
# LLM: codex
# Mode: assisted

import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.tree import DecisionTreeClassifier

music_data = pd.read_csv("music.csv", usecols=["age", "gender", "genre"])
y = music_data.pop("genre")
X = music_data

X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42
)

model = DecisionTreeClassifier(random_state=42)
model.fit(X_train, y_train)

accuracy = model.score(X_test, y_test)
print(f"ACCURACY={accuracy:.6f}")

# OPTIMIZATION SUMMARY
# - Loaded only required columns to reduce I/O and memory usage.
# - Used pop to extract the target without creating an extra DataFrame copy.
# - Replaced explicit predictions and accuracy_score with model.score to reduce intermediate data.
# - Set random_state for reproducible splits and model training.