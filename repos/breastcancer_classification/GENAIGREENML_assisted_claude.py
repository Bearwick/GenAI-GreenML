# Generated by generate_llm_code.py
# LLM: claude
# Mode: assisted

import numpy as np
import pandas as pd
import os

np.random.seed(42)

def read_csv_robust(path):
    df = pd.read_csv(path)
    if df.shape[1] <= 1:
        df = pd.read_csv(path, sep=';', decimal=',')
    return df

def sigmoid(z):
    return 1.0 / (1.0 + np.exp(-z))

def initialize(dim):
    return np.zeros((dim, 1)), 0.0

def optimize(w, b, X, Y, num_iters, alpha):
    m = X.shape[1]
    inv_m = 1.0 / m
    for _ in range(num_iters):
        A = sigmoid(np.dot(w.T, X) + b)
        diff = A - Y
        dw = inv_m * np.dot(X, diff.T)
        db = inv_m * np.sum(diff)
        w = w - alpha * dw
        b = b - alpha * db
    return w, b

def predict(w, b, X):
    A = sigmoid(np.dot(w.T, X) + b)
    return (A > 0.5).astype(np.float64)

def main():
    train_x = np.array(read_csv_robust("cancer_data.csv"))
    train_y = np.array(read_csv_robust("cancer_data_y.csv"))

    X_train = train_x.T
    Y_train = train_y.T

    w, b = initialize(X_train.shape[0])
    w, b = optimize(w, b, X_train, Y_train, num_iters=190500, alpha=0.000000065)

    test_x = np.array(read_csv_robust("test_cancer_data.csv"))
    test_y = np.array(read_csv_robust("test_cancer_data_y.csv"))

    X_test = test_x.T
    Y_test = test_y.T

    y_prediction_test = predict(w, b, X_test)

    accuracy = 1.0 - np.mean(np.abs(y_prediction_test - Y_test))

    print(f"ACCURACY={accuracy:.6f}")

main()

# Optimization Summary
# - Removed all print statements, plots, and visualization code
# - Removed cost tracking list and per-iteration cost recording to avoid unnecessary memory allocation and list appends
# - Removed dictionary packing/unpacking for gradients and parameters; use direct variables instead
# - Eliminated redundant propagate function; inlined forward/backward pass directly in optimize loop
# - Precomputed inv_m (1/m) outside the loop to avoid repeated division
# - Replaced element-wise prediction loop with vectorized boolean comparison for predict()
# - Removed confusion matrix computation loops (not needed for accuracy output)
# - Removed unused training accuracy computation since only test accuracy is printed
# - Added robust CSV reading with semicolon/decimal fallback
# - Set fixed random seed for reproducibility
# - No artifacts saved to disk