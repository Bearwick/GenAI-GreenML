# Generated by generate_llm_code.py
# LLM: codex
# Mode: assisted

import numpy as np
import pandas as pd


def sigmoid(z):
    return 1.0 / (1.0 + np.exp(-z))


def load_data(x_path, y_path):
    X = pd.read_csv(x_path, dtype=np.float64).to_numpy()
    Y = pd.read_csv(y_path, dtype=np.float64).to_numpy()
    return X.T, Y.T


def train_logistic_regression(X, Y, num_iters, alpha, record_cost=False):
    m = X.shape[1]
    w = np.zeros((X.shape[0], 1))
    b = 0.0
    m_inv = 1.0 / m
    alpha_m_inv = alpha * m_inv
    costs = []
    if record_cost:
        y_inv = 1.0 - Y
        for i in range(num_iters):
            A = sigmoid(w.T @ X + b)
            if i % 100 == 0:
                cost = -m_inv * np.sum(Y * np.log(A) + y_inv * np.log(1.0 - A))
                costs.append(float(cost))
            A -= Y
            w -= alpha_m_inv * (X @ A.T)
            b -= alpha_m_inv * A.sum()
    else:
        for _ in range(num_iters):
            A = sigmoid(w.T @ X + b)
            A -= Y
            w -= alpha_m_inv * (X @ A.T)
            b -= alpha_m_inv * A.sum()
    return w, b, costs


def predict(w, b, X):
    return (sigmoid(w.T @ X + b) > 0.5).astype(np.float64)


def model(X_train, Y_train, num_iters=2000, alpha=0.5, print_cost=False, X_test=None, Y_test=None):
    w, b, costs = train_logistic_regression(X_train, Y_train, num_iters, alpha, record_cost=print_cost)
    if X_test is None or Y_test is None:
        X_test, Y_test = load_data("test_cancer_data.csv", "test_cancer_data_y.csv")
    y_pred_test = predict(w, b, X_test)
    y_pred_train = predict(w, b, X_train)
    accuracy = np.mean(y_pred_test == Y_test)
    return accuracy, {
        "costs": costs,
        "Y_prediction_test": y_pred_test,
        "Y_prediction_train": y_pred_train,
        "w": w,
        "b": b,
        "learning_rate": alpha,
        "num_iterations": num_iters,
    }


def main():
    X_train, Y_train = load_data("cancer_data.csv", "cancer_data_y.csv")
    X_test, Y_test = load_data("test_cancer_data.csv", "test_cancer_data_y.csv")
    accuracy, _ = model(
        X_train,
        Y_train,
        num_iters=190500,
        alpha=0.000000065,
        print_cost=False,
        X_test=X_test,
        Y_test=Y_test,
    )
    print(f"ACCURACY={accuracy:.6f}")


if __name__ == "__main__":
    main()

# OPTIMIZATION SUMMARY
# - Removed plotting, verbose metric calculations, and unused outputs to cut I/O and compute overhead.
# - Vectorized prediction thresholding to replace per-sample loops.
# - Skipped cost computation unless explicitly requested to avoid redundant log operations.
# - Reused sigmoid output for gradient updates to reduce temporary array allocations.
# - Precomputed constants and used in-place arithmetic to lower repeated computations.
# - Loaded CSV data directly into numpy arrays to reduce unnecessary data movement.