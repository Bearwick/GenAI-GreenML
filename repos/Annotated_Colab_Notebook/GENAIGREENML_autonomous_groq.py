# Generated by generate_llm_code_2.py
# LLM: groq
# Mode: autonomous

import pandas as pd
from scipy.io import arff
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score

# Load ARFF dataset
data, meta = arff.loadarff("dataset_adult.arff")
df = pd.DataFrame(data)

# Decode byte strings to utf-8 and convert target to binary numeric
for col in df.select_dtypes([object]).columns:
    df[col] = df[col].str.decode('utf-8')
df['income'] = df['income'].apply(lambda x: 1 if x.strip() == '>50K' else 0)

# One‑hot encode categorical variables
df_encoded = pd.get_dummies(df, drop_first=True)

# Separate features and target
X = df_encoded.drop('income', axis=1)
y = df_encoded['income']

# Train‑test split
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.3, random_state=42, stratify=y
)

# Energy‑efficient classifier: Logistic Regression with default liblinear solver
clf = LogisticRegression(max_iter=200, random_state=42)
clf.fit(X_train, y_train)

# Predict and evaluate
y_pred = clf.predict(X_test)
accuracy = accuracy_score(y_test, y_pred)
print(f"ACCURACY={accuracy:.6f}")