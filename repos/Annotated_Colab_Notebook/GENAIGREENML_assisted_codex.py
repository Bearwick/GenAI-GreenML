# Generated by generate_llm_code.py
# LLM: codex
# Mode: assisted

from scipy.io import arff
import pandas as pd
import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import accuracy_score

SEED = 42
np.random.seed(SEED)

def load_dataset(path):
    try:
        data, _ = arff.loadarff(path)
        df = pd.DataFrame(data)
    except Exception:
        df = pd.read_csv(path)
        if df.shape[1] <= 1:
            df = pd.read_csv(path, sep=";", decimal=",")
    return df

def decode_bytes_columns(df):
    obj_cols = df.select_dtypes(include=["object"]).columns
    byte_types = (bytes, bytearray, np.bytes_)
    for col in obj_cols:
        series = df[col]
        sample = next((v for v in series.values if isinstance(v, byte_types)), None)
        if sample is not None:
            df[col] = series.str.decode("utf-8")
    return df

file_path = "dataset_adult.arff"
df = load_dataset(file_path)
df = decode_bytes_columns(df)

target_col = df.columns[-1]
target_series = df.pop(target_col)

y_df = pd.get_dummies(target_series, drop_first=True)
y = y_df.iloc[:, 0] if y_df.shape[1] > 0 else pd.Series(dtype="int64")

X = pd.get_dummies(df, drop_first=True)

X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.3, random_state=SEED
)

clf = RandomForestClassifier(random_state=SEED)
clf.fit(X_train, y_train)

y_pred = clf.predict(X_test)
accuracy = accuracy_score(y_test, y_pred)
print(f"ACCURACY={accuracy:.6f}")

# Optimization Summary
# Used in-place target extraction to avoid an extra feature copy.
# Encoded the target separately to skip redundant dummy columns.
# Decoded categorical byte columns only when needed to reduce processing.
# Removed unnecessary reporting steps to cut computation and output.
# Fixed random seeding for deterministic results.