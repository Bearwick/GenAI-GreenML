# Generated by generate_llm_code.py
# LLM: codex
# Mode: assisted

import numpy as np
import random
from src.preprocessing import load_and_preprocess
from src.modeling import train_models

FEATURES = ('CO(GT)', 'NOx(GT)', 'NO2(GT)', 'C6H6(GT)', 'T', 'RH')
SEED = 42

def set_seed(seed=SEED):
    random.seed(seed)
    np.random.seed(seed)

def compute_accuracy(y_true, y_pred):
    y_true_arr = np.asarray(y_true)
    y_pred_arr = np.asarray(y_pred)
    if y_true_arr.size == 0:
        return 0.0
    return float((y_true_arr == y_pred_arr).mean())

def main():
    set_seed()
    data = load_and_preprocess('data/AirQualityUCI.csv')
    _, _, _, _, _, _, _, y_clf_test, y_clf_pred = train_models(data, FEATURES)
    accuracy = compute_accuracy(y_clf_test, y_clf_pred)
    print(f"ACCURACY={accuracy:.6f}")

if __name__ == "__main__":
    main()

# Optimizations applied:
# - Removed visualization and verbose reporting to avoid heavy plotting overhead.
# - Reduced imports to essentials to cut module load time and memory use.
# - Used a constant feature tuple to prevent repeated allocations.
# - Computed accuracy with vectorized numpy for lightweight evaluation.
# - Set a fixed seed to improve reproducibility.