# Generated by generate_llm_code.py
# LLM: chatgpt
# Mode: original_telemetry

import pandas as pd
from src.preprocessing import load_and_preprocess
from src.modeling import train_models
from src.visualization import plot_correlation_heatmap
from src.plots import (
    plot_regression_performance,
    plot_confusion_matrix,
    plot_roc_curve,
    plot_feature_importance,
)
from sklearn.metrics import accuracy_score


def main():
    data = load_and_preprocess("data/AirQualityUCI.csv")
    features = ["CO(GT)", "NOx(GT)", "NO2(GT)", "C6H6(GT)", "T", "RH"]

    (
        reg_model,
        clf_model,
        reg_results,
        clf_results,
        X_test,
        y_reg_test,
        y_pred_reg,
        y_clf_test,
        y_clf_pred,
    ) = train_models(data, features)

    accuracy = accuracy_score(y_clf_test, y_clf_pred)
    print(f"ACCURACY={accuracy:.6f}")


if __name__ == "__main__":
    main()