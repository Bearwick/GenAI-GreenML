# Generated by generate_llm_code.py
# LLM: chatgpt
# Mode: assisted

import os
import random
import numpy as np
from sklearn.metrics import accuracy_score
from src.preprocessing import load_and_preprocess
from src.modeling import train_models


def set_reproducibility(seed: int = 42) -> None:
    os.environ["PYTHONHASHSEED"] = str(seed)
    random.seed(seed)
    np.random.seed(seed)


def main() -> None:
    set_reproducibility(42)

    data = load_and_preprocess("data/AirQualityUCI.csv")
    features = ["CO(GT)", "NOx(GT)", "NO2(GT)", "C6H6(GT)", "T", "RH"]

    _, _, _, _, _, _, _, y_clf_test, y_clf_pred = train_models(data, features)

    accuracy = accuracy_score(y_clf_test, y_clf_pred)
    print(f"ACCURACY={accuracy:.6f}")


if __name__ == "__main__":
    main()

# Optimizations applied:
# 1) Removed unused imports (pandas, matplotlib, visualization/plot modules) to reduce import time and memory footprint.
# 2) Removed all plotting/visualization and related intermediate computations (e.g., predict_proba for ROC) to avoid extra model inference and overhead.
# 3) Removed all non-essential prints to reduce I/O overhead; kept only required accuracy output.
# 4) Added reproducibility controls (fixed seeds) for stable results and to avoid reruns due to nondeterminism.