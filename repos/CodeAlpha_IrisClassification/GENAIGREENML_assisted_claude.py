# Generated by generate_llm_code.py
# LLM: claude
# Mode: assisted

import pandas as pd
import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import LabelEncoder
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score

DATASET_PATH = "Iris.csv"

try:
    data = pd.read_csv(DATASET_PATH)
    if data.shape[1] <= 2:
        data = pd.read_csv(DATASET_PATH, sep=';', decimal=',')
except Exception:
    data = pd.read_csv(DATASET_PATH, sep=';', decimal=',')

id_cols = [c for c in data.columns if c.lower() == 'id']
if id_cols:
    data.drop(columns=id_cols, inplace=True)

species_col = [c for c in data.columns if c.lower() == 'species'][0]

X = data.drop(columns=[species_col]).values
le = LabelEncoder()
y = le.fit_transform(data[species_col])

X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.2, random_state=42, stratify=y
)

model = LogisticRegression(max_iter=200, solver='lbfgs', random_state=42)
model.fit(X_train, y_train)

y_pred = model.predict(X_test)
accuracy = accuracy_score(y_test, y_pred)

print(f"ACCURACY={accuracy:.6f}")

# Optimization Summary
# Removed RandomForestClassifier: LogisticRegression achieves the same accuracy on Iris and is much lighter in computation and memory.
# Removed seaborn/matplotlib imports and all visualization code to eliminate unnecessary dependencies and rendering overhead.
# Removed all intermediate print/logging statements to reduce I/O overhead.
# Used .values to pass numpy array directly to sklearn, avoiding repeated DataFrame indexing.
# Robust CSV fallback: tries default separator first, falls back to sep=';' and decimal=',' if needed.
# Column names derived dynamically from actual data rather than hardcoded.
# Fixed random_state on both train_test_split and LogisticRegression for reproducibility.
# Dropped the Id column detection using case-insensitive matching for robustness.
# Removed redundant confusion_matrix and classification_report computations since only accuracy is needed.