# Generated by generate_llm_code.py
# LLM: chatgpt
# Mode: original_telemetry

import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import LabelEncoder
from sklearn.linear_model import LogisticRegression
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import accuracy_score


def main() -> None:
    try:
        data = pd.read_csv("C:/Users/Lalit Pathak/python2.0/Iris.csv")
    except FileNotFoundError:
        exit()

    if "Id" in data.columns:
        data.drop(columns=["Id"], inplace=True)

    if "Species" not in data.columns:
        exit()

    X = data.drop(columns=["Species"])
    y = data["Species"]

    le = LabelEncoder()
    y_encoded = le.fit_transform(y)

    X_train, X_test, y_train, y_test = train_test_split(
        X, y_encoded, test_size=0.2, random_state=42, stratify=y_encoded
    )

    log_reg = LogisticRegression(max_iter=200)
    log_reg.fit(X_train, y_train)
    y_pred_log = log_reg.predict(X_test)

    rf_model = RandomForestClassifier(n_estimators=100, random_state=42)
    rf_model.fit(X_train, y_train)
    y_pred_rf = rf_model.predict(X_test)

    accuracy = accuracy_score(y_test, y_pred_rf)
    print(f"ACCURACY={accuracy:.6f}")


if __name__ == "__main__":
    main()