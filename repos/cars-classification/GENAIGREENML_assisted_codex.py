# Generated by generate_llm_code.py
# LLM: codex
# Mode: assisted

import pandas as pd
import numpy as np
import random
from sklearn.model_selection import train_test_split
from sklearn.svm import SVC

DATASET_PATH = "cars.csv"
DATASET_HEADERS = "mpg, cylinders, cubicinches, hp, weightlbs, time-to-60, year, brand"


def _normalize(col):
    return "".join(ch for ch in str(col).lower() if ch.isalnum())


def read_dataset(path, expected):
    df = pd.read_csv(path)
    if df.shape[1] == 1 or df.shape[1] < len(expected):
        df_alt = pd.read_csv(path, sep=";", decimal=",")
        if df_alt.shape[1] > df.shape[1]:
            df = df_alt
    if any(str(c).lower().startswith("unnamed") for c in df.columns):
        df = df.loc[:, [c for c in df.columns if not str(c).lower().startswith("unnamed")]]
    return align_columns(df, expected)


def align_columns(df, expected):
    df_cols = list(df.columns)
    if df_cols == expected:
        return df
    norm_map = {_normalize(c): c for c in df_cols}
    expected_norm = [_normalize(h) for h in expected]
    if all(n in norm_map for n in expected_norm):
        df = df.loc[:, [norm_map[n] for n in expected_norm]]
        df.columns = expected
        return df
    if df.shape[1] >= len(expected):
        df = df.iloc[:, :len(expected)].copy()
        df.columns = expected
        return df
    df = df.copy()
    for i, h in enumerate(expected):
        if i >= df.shape[1]:
            df[h] = np.nan
    df = df.loc[:, expected]
    return df


def preprocess(df):
    df = df.copy()
    for col in ("cubicinches", "weightlbs"):
        if col in df.columns:
            df[col] = pd.to_numeric(df[col], errors="coerce")
    return df.dropna()


def main():
    np.random.seed(0)
    random.seed(0)
    expected = [h.strip() for h in DATASET_HEADERS.split(",")]
    df = read_dataset(DATASET_PATH, expected)
    df = preprocess(df)
    feature_cols = expected[:5]
    target_col = expected[-1]
    X = df.loc[:, feature_cols].to_numpy(copy=False)
    y = df.loc[:, target_col].to_numpy(copy=False)
    X_train, X_test, y_train, y_test = train_test_split(
        X, y, test_size=0.25, random_state=0
    )
    classifier = SVC()
    classifier.fit(X_train, y_train)
    accuracy = classifier.score(X_test, y_test)
    print(f"ACCURACY={accuracy:.6f}")


if __name__ == "__main__":
    main()

# Optimization Summary
# - Removed unused libraries and visualization steps to reduce runtime and imports.
# - Consolidated preprocessing into a single pass with targeted numeric conversion and one dropna.
# - Implemented robust CSV parsing and column alignment to avoid repeated manual adjustments.
# - Eliminated redundant predictions and used direct score computation for accuracy.