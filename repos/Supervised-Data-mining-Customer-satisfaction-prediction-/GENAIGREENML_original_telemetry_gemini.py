# Generated by generate_llm_code.py
# LLM: gemini
# Mode: original_telemetry

import numpy as np
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn import tree
from sklearn.model_selection import GridSearchCV
from sklearn import metrics
from imblearn.over_sampling import SMOTE  
from sklearn.ensemble import RandomForestClassifier, AdaBoostClassifier, GradientBoostingClassifier

EJdata = pd.read_csv("EireJet.csv")
pd.set_option('display.max_columns', None) 
print(EJdata.head())
print(EJdata.shape)
print(EJdata.info())
print(EJdata.describe())

EJdata = EJdata.dropna(how='any',axis=0) 
print(EJdata.info())

EJdata['Gender'] = EJdata['Gender'].map({'Female':1, 'Male':0})
EJdata['Frequent Flyer'] = EJdata['Frequent Flyer'].map({'Yes':1, 'No':0})
EJdata['Type of Travel'] = EJdata['Type of Travel'].map({'Personal Travel':1, 'Business travel':0})
EJdata['Class'] = EJdata['Class'].map({'Eco':0,'Eco Plus':1 ,'Business':2 })
EJdata['satisfaction'] = EJdata['satisfaction'].map({'neutral or dissatisfied':0, 'satisfied':1})
print(EJdata.info())

X = EJdata.drop('satisfaction', axis = 1) 
Y = EJdata['satisfaction'] 
print(type(X))
print(type(Y))
print(X.shape)
print(Y.shape)

feature_scaler = StandardScaler()
X_scaled = feature_scaler.fit_transform(X)

X_train, X_test, Y_train, Y_test = train_test_split( X_scaled, Y, test_size = 0.3, random_state = 100)

print(X_train.shape)
print(X_test.shape)

X_train, X_test, Y_train, Y_test = train_test_split( X_scaled, Y, test_size = 0.3, random_state = 100)

print(X_train.shape)
print(X_test.shape)

print("Number of observations in each class before oversampling (training data): \n", pd.Series(Y_train).value_counts())

smote = SMOTE(random_state = 101)
X_train,Y_train = smote.fit_sample(X_train,Y_train)

print("Number of observations in each class after oversampling (training data): \n", pd.Series(Y_train).value_counts())

rfc = RandomForestClassifier(criterion='entropy', max_features='auto', random_state=1)
grid_prm = {'n_estimators': [50, 100, 150, 200, 250, 300]}

gd_sr = GridSearchCV(estimator=rfc, param_grid=grid_prm, scoring='precision', cv=5)

gd_sr.fit(X_train, Y_train)

Bestparameter = gd_sr.best_params_
print(Bestparameter)

bestresult = gd_sr.best_score_ 
print(bestresult)

rfc = RandomForestClassifier(n_estimators=150, criterion='entropy', max_features='auto', random_state=1)
rfc.fit(X_train,Y_train)
featimport = pd.Series(rfc.feature_importances_, index=list(X)).sort_values(ascending=False)
print(featimport)

Y_pred = rfc.predict(X_test)
print('Classification report: \n', metrics.classification_report(Y_test, Y_pred))

conf_mat = metrics.confusion_matrix(Y_test, Y_pred)

print('Confusion matrix: \n', conf_mat)
print('TP: ', conf_mat[1,1])
print('TN: ', conf_mat[0,0])
print('FP: ', conf_mat[0,1])
print('FN: ', conf_mat[1,0])

Adaboost = AdaBoostClassifier(random_state=1)
gridparamt = {'n_estimators': [30,35,40,45,50,55,60]}

gd_sr = GridSearchCV(estimator=Adaboost, param_grid=grid_paramt, scoring='precision', cv=5)

gd_sr.fit(X_train, Y_train)

bestparameter = gd_sr.best_params_
print(bestparameter)

result = gd_sr.best_score_ 
print(result)

Adaboost = AdaBoostClassifier(n_estimators=50, random_state=1)
Adaboost.fit(X_train,Y_train)
featimport = pd.Series(Adaboost.feature_importances_, index=list(X)).sort_values(ascending=False)
print(featimport)

Y_pred = Adaboost.predict(X_test)
print('Classification report: \n', metrics.classification_report(Y_test, Y_pred))

conf_mat = metrics.confusion_matrix(Y_test, Y_pred)

print('Confusion matrix: \n', conf_mat)
print('TP: ', conf_mat[1,1])
print('TN: ', conf_mat[0,0])
print('FP: ', conf_mat[0,1])
print('FN: ', conf_mat[1,0])

Gradientboost = GradientBoostingClassifier(random_state=1)
grid_param = {'n_estimators': [100,150,200], 'max_depth' : [9,10,11,12], 'max_leaf_nodes': [8,12,16,20,24,28,32]}

grd_sr = GridSearchCV(estimator=Gradientboost, param_grid=grid_param, scoring='precision', cv=5)

grd_sr.fit(X_train, Y_train)

prime_parameters = grd_sr.best_params_
print(prime_parameters)

result = grd_sr.best_score_  
print(result)

Gradientboost = GradientBoostingClassifier(n_estimators=200, max_depth=9, max_leaf_nodes=32, random_state=1)
Gradientboost.fit(X_train,Y_train)
featimportance = pd.Series(Gradientboost.feature_importances_, index=list(X)).sort_values(ascending=False)
print(featimportance)

Y_pred = Gradientboost.predict(X_test)
print('Classification report: \n', metrics.classification_report(Y_test, Y_pred))

conf_mat = metrics.confusion_matrix(Y_test, Y_pred)

print('Confusion matrix: \n', conf_mat)
print('TP: ', conf_mat[1,1])
print('TN: ', conf_mat[0,0])
print('FP: ', conf_mat[0,1])
print('FN: ', conf_mat[1,0])

accuracy = metrics.accuracy_score(Y_test, Y_pred)
print(f"ACCURACY={accuracy:.6f}")