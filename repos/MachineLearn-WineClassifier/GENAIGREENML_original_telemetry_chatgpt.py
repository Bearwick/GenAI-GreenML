# Generated by generate_llm_code.py
# LLM: chatgpt
# Mode: original_telemetry

from sklearn.model_selection import train_test_split
from sklearn.ensemble import ExtraTreesClassifier
import pandas as pd

path = "data/wine_dataset.csv"
arquivo = pd.read_csv(path)

arquivo["style"] = arquivo["style"].astype(str).str.strip().str.lower()
arquivo = arquivo[arquivo["style"].isin(["red", "white"])].copy()
arquivo["style"] = arquivo["style"].map({"red": 0, "white": 1}).astype("int64")

X = arquivo.drop(columns=["style"])
y = arquivo["style"]

X = X.apply(pd.to_numeric, errors="coerce")
mask = X.notna().all(axis=1)
X = X[mask]
y = y[mask]

X_treino, X_teste, y_treino, y_teste = train_test_split(
    X, y, test_size=0.3, random_state=42, stratify=y
)

modelo = ExtraTreesClassifier(n_estimators=100, random_state=42)
modelo.fit(X_treino, y_treino)

accuracy = modelo.score(X_teste, y_teste)
print(f"ACCURACY={accuracy:.6f}")

previsoes = modelo.predict(X_teste.iloc[300:600])