# Generated by generate_llm_code.py
# LLM: groq
# Mode: autonomous

import pandas as pd
from sklearn.preprocessing import StandardScaler
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score

def load_dataset(path):
    """Read a CSV file containing diabetes data."""
    return pd.read_csv(path)

def preprocess(df):
    """Separate features and target, then scale numerical features."""
    X = df.drop(columns=['class'])
    y = df['class']
    scaler = StandardScaler()
    X_scaled = scaler.fit_transform(X)
    return X_scaled, y

def main():
    # Load training and test data
    train_df = load_dataset('Diabetes-Training.csv')
    test_df  = load_dataset('Diabetes-Clasification.csv')

    # Preprocess data
    X_train, y_train = preprocess(train_df)
    X_test,  y_test  = preprocess(test_df)

    # Model: lightweight Logistic Regression (energy‑efficient, CPU‑friendly)
    model = LogisticRegression(max_iter=1000, solver='liblinear', penalty='l2')
    model.fit(X_train, y_train)

    # Predict and evaluate
    y_pred = model.predict(X_test)
    acc = accuracy_score(y_test, y_pred)

    # Single required output
    print(f"ACCURACY={acc:.6f}")

if __name__ == "__main__":
    main()