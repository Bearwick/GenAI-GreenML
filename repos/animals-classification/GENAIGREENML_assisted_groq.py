# Generated by generate_llm_code.py
# LLM: groq
# Mode: assisted

import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.svm import SVC
from sklearn.metrics import accuracy_score
import joblib

# Load dataset
dataset = pd.read_csv('zoo.csv')
X = dataset.iloc[:, 1:17].values
y = dataset.iloc[:, 17].values

# Split data
X_train, X_test, y_train, y_test = train_test_split(
    X, y, test_size=0.25, random_state=0, stratify=y
)

# Train SVM
classifier = SVC(random_state=0)
classifier.fit(X_train, y_train)

# Predict and evaluate
y_pred = classifier.predict(X_test)
accuracy = accuracy_score(y_test, y_pred)
print(f"ACCURACY={accuracy:.6f}")

# Persist model
joblib.dump(classifier, 'svm_zoo_model.joblib')

# Optimizations applied:
# 1. Removed unnecessary libraries (seaborn, matplotlib) to lower memory and CPU usage.
# 2. Eliminated unused data variables and intermediate structures.
# 3. Used sklearn's built-in accuracy_score for direct evaluation, avoiding manual confusion matrix logic.
# 4. Set random_state and stratify in train_test_split for reproducibility without extra overhead.
# 5. Saved the trained model to disk instead of keeping it in memory indefinitely.