# Generated by generate_llm_code.py
# LLM: chatgpt
# Mode: original_telemetry

import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.feature_extraction.text import CountVectorizer
from sklearn import svm

email = pd.read_csv("emails.csv")

x = email["text"]
y = email["spam"]

x_train, x_test, y_train, y_test = train_test_split(
    x, y, test_size=0.2, random_state=1000
)

cv = CountVectorizer()
features = cv.fit_transform(x_train)

linear_model = svm.SVC()
linear_model.fit(features, y_train)

feature_test = cv.transform(x_test)
accuracy = linear_model.score(feature_test, y_test)
print(f"ACCURACY={accuracy:.6f}")


def predict_email(text):
    text_feature = cv.transform([text])
    prediciting_email = linear_model.predict(text_feature)
    return prediciting_email[0]