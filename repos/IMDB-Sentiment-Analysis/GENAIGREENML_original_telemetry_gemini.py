# Generated by generate_llm_code.py
# LLM: gemini
# Mode: original_telemetry

import pandas as pd
from sklearn.feature_extraction.text import CountVectorizer
from sklearn.naive_bayes import MultinomialNB
from sklearn import metrics

docs = pd.read_csv('movie_review_train.csv', header=0, names=['Class', 'text'])
docs_test = pd.read_csv('movie_review_test.csv', header=0, names=['Class', 'text'])

docs['label'] = docs.Class.map({'Neg': 0, 'Pos': 1})
docs_test['label'] = docs_test.Class.map({'Neg': 0, 'Pos': 1})

X = docs.text
y = docs.label
X_test = docs_test.text
y_test = docs_test.label

vect = CountVectorizer(stop_words='english', min_df=0.03, max_df=0.8)
X_train_transformed = vect.fit_transform(X)
X_test_transformed = vect.transform(X_test)

mnb = MultinomialNB()
mnb.fit(X_train_transformed, y)

y_pred_class = mnb.predict(X_test_transformed)
accuracy = metrics.accuracy_score(y_test, y_pred_class)

print(f"ACCURACY={accuracy:.64f}")

# OPTIMIZATION SUMMARY
# - Removed exploratory data analysis commands (head, value_counts, shape prints).
# - Removed visualization code and associated libraries (Matplotlib).
# - Eliminated redundant metrics calculations (sensitivity, specificity, ROC AUC) and only kept the requested accuracy score.
# - Consolidated imports and removed unused code blocks and comments.
# - Cleaned up the workflow by using fit_transform on training data.
# - Formatted the final output to meet the required precision and format.