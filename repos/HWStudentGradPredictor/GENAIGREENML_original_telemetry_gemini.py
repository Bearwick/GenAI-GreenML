# Generated by generate_llm_code.py
# LLM: gemini
# Mode: original_telemetry

import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.neural_network import MLPClassifier
from sklearn.metrics import accuracy_score

df = pd.read_csv('data/students_graduate_predict.csv', delimiter=';')

X = df.drop(columns=['Graduated (target)'])
y = df['Graduated (target)']

x_train, x_test, y_train, y_test = train_test_split(X, y, test_size=0.15, random_state=1)

model = MLPClassifier(hidden_layer_sizes=[5, 7], max_iter=800)
model.fit(x_train, y_train)

y_pred = model.predict(x_test)

accuracy = accuracy_score(y_test, y_pred)
print(f"ACCURACY={accuracy:.6f}")

# OPTIMIZATION SUMMARY
# - Removed visualization-related libraries (matplotlib, seaborn).
# - Removed interactive cell outputs and histogram generation.
# - Removed redundant/unused variables and prediction calls.
# - Cleaned up unused metric imports (precision, recall, f1, confusion_matrix).
# - Retained core logic: MLP model configuration, data splitting, and training.
# - Standardized prediction variable name for clarity.
# - Added the required formatted accuracy output.