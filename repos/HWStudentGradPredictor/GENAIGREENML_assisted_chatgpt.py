# Generated by generate_llm_code.py
# LLM: chatgpt
# Mode: assisted

import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.neural_network import MLPClassifier
from sklearn.metrics import accuracy_score


def load_data(path: str) -> pd.DataFrame:
    return pd.read_csv(path, delimiter=";")


def split_xy(df: pd.DataFrame, target_col: str):
    y = df[target_col]
    X = df.drop(columns=[target_col])
    return X, y


def train_model(X_train, y_train, random_state: int = 1) -> MLPClassifier:
    model = MLPClassifier(
        hidden_layer_sizes=(5, 7),
        max_iter=800,
        random_state=random_state,
        solver="adam",
        early_stopping=True,
        n_iter_no_change=10,
        validation_fraction=0.1,
    )
    model.fit(X_train, y_train)
    return model


def main() -> None:
    df = load_data("data/students_graduate_predict.csv")
    X, y = split_xy(df, "Graduated (target)")

    X_train, X_test, y_train, y_test = train_test_split(
        X, y, test_size=0.15, random_state=1
    )

    model = train_model(X_train, y_train, random_state=1)
    y_pred = model.predict(X_test)

    accuracy = accuracy_score(y_test, y_pred)
    print(f"ACCURACY={accuracy:.6f}")


if __name__ == "__main__":
    main()

# OPTIMIZATION SUMMARY
# Removed unused computations/side-effects: eliminated dataframe display, histogram, confusion matrix heatmap, and extra metric calculations not required for final output.
# Reduced redundant predictions and allocations: removed predictions on arbitrary rows and creation of an intermediate DataFrame comparing predictions vs truth.
# Improved training efficiency with stable results: enabled early_stopping to avoid unnecessary epochs while keeping max_iter as an upper bound; set random_state for reproducibility.
# Lowered overhead: trimmed imports to only what is used (no matplotlib/seaborn/confusion matrix/precision/recall/f1), reducing load time and memory footprint.
# Kept data movement minimal: performed a single read, single split, single fit, single predict; avoided extra intermediate structures.