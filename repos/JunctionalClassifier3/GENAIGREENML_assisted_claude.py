# Generated by generate_llm_code.py
# LLM: claude
# Mode: assisted

import numpy as np
from sklearn import svm, metrics
from sklearn.model_selection import train_test_split
import pandas as pd

RANDOM_SEED = 42

def load_csv(filename):
    try:
        df = pd.read_csv(filename)
    except Exception:
        try:
            df = pd.read_csv(filename, sep=';', decimal=',')
        except Exception:
            return np.empty((0, 0)), np.empty(0)
    values = df.values.astype(np.float64)
    features = values[:, :-1]
    raw_labels = values[:, -1]
    labels = np.where(raw_labels > 0, 1.0, np.where(raw_labels < 0, -1.0, 0.0))
    return features, labels

def train_and_evaluate():
    features, labels = load_csv('14k.csv')
    feat_train, feat_test, lab_train, lab_test = train_test_split(
        features, labels, test_size=0.3, random_state=RANDOM_SEED
    )
    clf = svm.SVC(kernel='linear')
    clf.fit(feat_train, lab_train)
    prediction = clf.predict(feat_test)
    accuracy = metrics.accuracy_score(lab_test, prediction)
    print(f"ACCURACY={accuracy:.6f}")

train_and_evaluate()

# Optimization Summary
# Replaced manual CSV parsing with pandas.read_csv for faster I/O and reduced code complexity.
# Added robust CSV fallback with sep=';' and decimal=',' if default parsing fails.
# Used numpy vectorized operations for label transformation instead of per-row Python loops.
# Removed global mutable state (features, labels, pFeatures lists) in favor of local variables.
# Removed pickle load/save to avoid unnecessary file I/O side effects.
# Removed predict() and takeInput() functions that depended on external files not related to training evaluation.
# Removed unittest class since the task is model training/evaluation, not testing auxiliary CSVs.
# Removed all print statements, plots, and interactive inputs per requirements.
# Set fixed random_state for reproducibility in train_test_split.
# Eliminated redundant copy/csv/pickle imports to reduce memory footprint.
# Single-pass numpy array construction instead of building Python lists then converting.