# Generated by generate_llm_code.py
# LLM: groq
# Mode: autonomous

import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.pipeline import Pipeline
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score

def is_sick(x):
    return 0 if x in (3, 7) else 1

def main():
    cols = [
        'age', 'sex', 'chest pain', 'resting blood pressure', 'serum cholesterol',
        'fasting blood sugar', 'resting electrocardiographic results',
        'maximum heart rate achieved', 'exercise induced angina',
        'ST depression induced by exercise relative to rest',
        'the slope of the peak exercise ST segment', 'number of major vessels',
        'thal', 'last'
    ]
    data = pd.read_csv('heart.csv', delimiter=' ', header=None, names=cols)
    data = data.iloc[:, :13]
    data['label'] = data['thal'].apply(is_sick)
    X = data.iloc[:, :13]
    y = data['label']
    X_train, X_test, y_train, y_test = train_test_split(
        X, y, test_size=0.5, random_state=42, stratify=y
    )
    pipe = Pipeline([
        ('scaler', StandardScaler()),
        ('clf', LogisticRegression(max_iter=100, n_jobs=1, solver='liblinear'))
    ])
    pipe.fit(X_train, y_train)
    y_pred = pipe.predict(X_test)
    acc = accuracy_score(y_test, y_pred)
    print(f"ACCURACY={acc:.6f}")

if __name__ == "__main__":
    main()