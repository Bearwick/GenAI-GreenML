# Generated by generate_llm_code.py
# LLM: claude
# Mode: autonomous

import os
import json
import csv
import re
import numpy as np
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import LabelEncoder, StandardScaler
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score
from sklearn.pipeline import Pipeline

# ---------------------------------------------------------------------------
# This script adapts the provided zero-shot intent-classification source code
# into an energy-efficient, CPU-friendly ML pipeline that:
#   1. Generates a synthetic training dataset from the intent categories
#      (since no labeled CSV dataset was provided, we create representative
#       examples for each intent class).
#   2. Trains a lightweight Logistic Regression model on TF-IDF features.
#   3. Evaluates on a held-out test set and prints accuracy.
#   4. Also provides the full predict_intents workflow writing JSON/CSV
#      output, using the trained lightweight model instead of a heavy
#      transformer.
# ---------------------------------------------------------------------------

# ---- Intent labels (same as source) ----
INTENT_OPTIONS = [
    "Book Appointment",
    "Product Inquiry",
    "Pricing Negotiation",
    "Support Request",
    "Follow-Up",
]

# ---- Synthetic training data ----
# We create a small but diverse set of example utterances per intent.
# This is necessary because no external labeled dataset was supplied.
SYNTHETIC_DATA = {
    "Book Appointment": [
        "I would like to schedule an appointment for next Tuesday",
        "Can I book a meeting with the sales team?",
        "I need to set up an appointment with the doctor",
        "Please reserve a slot for me tomorrow at 3 PM",
        "Is there availability for an appointment this week?",
        "I want to book a consultation for Friday morning",
        "Schedule me in for a visit on Monday",
        "Can we arrange a meeting sometime this week?",
        "I'd like to make an appointment please",
        "Book me a session with the advisor",
        "How do I schedule a call with your team?",
        "I need an appointment as soon as possible",
        "Please book a time slot for me",
        "Can I get an appointment for the 15th?",
        "Set up a meeting for me with the manager",
        "I want to reserve a spot for the workshop",
        "Is it possible to arrange a visit tomorrow?",
        "I need to see someone about my account, can I book a time?",
        "Let me schedule a follow-up appointment",
        "Can you pencil me in for next week?",
    ],
    "Product Inquiry": [
        "Can you tell me more about the new product line?",
        "What features does the premium plan include?",
        "I'm interested in learning about your services",
        "Do you have this item in stock?",
        "What are the specifications of the latest model?",
        "Can you send me the product catalog?",
        "I want to know more about your offerings",
        "What is the difference between the basic and pro versions?",
        "Tell me about the warranty on this product",
        "Is this product available in different colors?",
        "What materials is this product made from?",
        "Do you have any new arrivals?",
        "Can I get more details about this service?",
        "What options are available for customization?",
        "I'd like information about your product range",
        "How does this product compare to the competition?",
        "What are the technical specs?",
        "Do you offer a trial version of the software?",
        "Tell me about the features of the enterprise plan",
        "Is there a demo I can try before purchasing?",
    ],
    "Pricing Negotiation": [
        "Can we discuss the pricing for a bulk order?",
        "Is there a discount available for long-term contracts?",
        "The price seems a bit high, can you offer something better?",
        "What is your best price for this product?",
        "We are looking at a large order, can we negotiate?",
        "Are there any current promotions or deals?",
        "Can you match the