# Generated by generate_llm_code.py
# LLM: groq
# Mode: autonomous

import numpy as np
import pandas as pd
from sklearn.linear_model import LogisticRegression
from sklearn.impute import SimpleImputer
from sklearn.metrics import accuracy_score
from sklearn.pipeline import Pipeline

def load_and_preprocess(path: str) -> (np.ndarray, np.ndarray):
    df = pd.read_csv(path, dtype=np.float32)
    if 'class' in df.columns:
        df['class'] = df['class'].replace({'CN': 0, 'DYS': 1}).astype(np.int32)
        y = df['class'].values
        X = df.drop(columns=['class']).values.astype(np.float32)
    else:
        y = df.iloc[:, -1].values
        X = df.iloc[:, :-1].values
    return X, y

def main():
    train_path = "entire brain_training_2.csv"
    test_path = "entire brain_test_2.csv"
    X_train, y_train = load_and_preprocess(train_path)
    X_test, y_test = load_and_preprocess(test_path)

    pipe = Pipeline([
        ('imputer', SimpleImputer(strategy='median')),
        ('clf', LogisticRegression(max_iter=1000, n_jobs=1, solver='lbfgs'))
    ])

    pipe.fit(X_train, y_train)
    y_pred = pipe.predict(X_test)
    acc = accuracy_score(y_test, y_pred)
    print(f"ACCURACY={acc:.6f}")

if __name__ == "__main__":
    main()