# Generated by generate_llm_code.py
# LLM: claude
# Mode: assisted

import numpy as np
import pandas as pd
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import confusion_matrix

RANDOM_SEED = 42

def load_csv_robust(filepath):
    df = pd.read_csv(filepath)
    if df.shape[1] < 3:
        df = pd.read_csv(filepath, sep=';', decimal=',')
    return df

def confmatrix_of_RandomForest(trainingdata_filepath, testdata_filepath, criterion="entropy"):
    training_data = load_csv_robust(trainingdata_filepath)
    test_data = load_csv_robust(testdata_filepath)

    drop_cols_train = [c for c in training_data.columns if c not in
                       set(pd.Index([
                           'AF3_Shannon','AF3_Energy0_4','AF3_Energy4_8','AF3_Energy8_10','AF3_Energy10_12',
                           'AF3_Energy13_19','AF3_Energy20_30','AF3_Energy30_60','F3_Shannon','F3_Energy0_4',
                           'F3_Energy4_8','F3_Energy8_10','F3_Energy10_12','F3_Energy13_19','F3_Energy20_30',
                           'F3_Energy30_60','F7_Energy0_4','F7_Energy4_8','F7_Energy8_10','F7_Energy10_12',
                           'F7_Energy13_19','F7_Energy20_30','F7_Energy30_60','FC5_Shannon','FC5_Energy0_4',
                           'FC5_Energy4_8','FC5_Energy8_10','FC5_Energy10_12','FC5_Energy13_19','FC5_Energy20_30',
                           'FC5_Energy30_60','O1_Shannon','O1_Energy0_4','O1_Energy4_8','O1_Energy8_10',
                           'O1_Energy10_12','O1_Energy13_19','O1_Energy20_30','O1_Energy30_60','P7_Shannon',
                           'P7_Energy0_4','P7_Energy4_8','P7_Energy8_10','P7_Energy10_12','P7_Energy13_19',
                           'P7_Energy20_30','P7_Energy30_60','T7_Shannon','T7_Energy0_4','T7_Energy4_8',
                           'T7_Energy8_10','T7_Energy10_12','T7_Energy13_19','T7_Energy20_30','T7_Energy30_60',
                           'AF4_Shannon','AF4_Energy0_4','AF4_Energy4_8','AF4_Energy8_10','AF4_Energy10_12',
                           'AF4_Energy13_19','AF4_Energy20_30','AF4_Energy30_60','F4_Shannon','F4_Energy0_4',
                           'F4_Energy4_8','F4_Energy8_10','F4_Energy10_12','F4_Energy13_19','F4_Energy20_30',
                           'F4_Energy30_60','F8_Shannon','F8_Energy0_4','F8_Energy4_8','F8_Energy8_10',
                           'F8_Energy10_12','F8_Energy13_19','F8_Energy20_30','F8_Energy30_60','FC6_Shannon',
                           'FC6_Energy0_4','FC6_Energy4_8','FC6_Energy8_10','FC6_Energy10_12','FC6_Energy13_19',
                           'FC6_Energy20_30','FC6_Energy30_60','O2_Shannon','O2_Energy0_4','O2_Energy4_8',
                           'O2_Energy8_10','O2_Energy10_12','O2_Energy13_19','O2_Energy20_30','O2_Energy30_60',
                           'T8_