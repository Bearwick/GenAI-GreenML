# Generated by generate_llm_code.py
# LLM: gemini
# Mode: assisted

import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.linear_model import LogisticRegression

def load_data_optimized(filepath, label):
    try:
        df = pd.read_csv(filepath, usecols=['text'])
    except Exception:
        df = pd.read_csv(filepath, sep=';', decimal=',', usecols=['text'])
    df['label'] = label
    return df

def train_and_evaluate():
    seed = 42
    
    df_fake = load_data_optimized("Fake.csv", 0)
    df_real = load_data_optimized("True.csv", 1)
    
    df = pd.concat([df_fake, df_real], ignore_index=True)
    
    X_train, X_test, y_train, y_test = train_test_split(
        df['text'], 
        df['label'], 
        test_size=0.2, 
        random_state=seed
    )
    
    vectorizer = TfidfVectorizer(stop_words='english', max_df=0.7)
    X_train_tfidf = vectorizer.fit_transform(X_train)
    
    model = LogisticRegression(random_state=seed, solver='liblinear')
    model.fit(X_train_tfidf, y_train)
    
    X_test_tfidf = vectorizer.transform(X_test)
    accuracy = model.score(X_test_tfidf, y_test)
    
    print(f"ACCURACY={accuracy:.6f}")

if __name__ == '__main__':
    train_and_evaluate()

# Optimization Summary
# - Memory Efficiency: Utilized the 'usecols' parameter in pandas.read_csv to only load the necessary 'text' column, reducing the memory footprint of the dataframes.
# - Reduced I/O Overhead: Removed joblib serialization (saving .pkl files) to eliminate unnecessary disk write operations and save energy.
# - Computational Streamlining: Replaced intermediate data manipulation steps with an optimized concatenation approach using 'ignore_index' to avoid index reconstruction.
# - Data Movement reduction: Performed labeling directly on loaded subsets to avoid iterating over the combined dataset multiple times.
# - Resource Conservation: Removed all logging, debug prints, and visualizations to reduce runtime and CPU cycles.
# - Stability and Reproducibility: Added a fixed random seed to train_test_split and LogisticRegression to ensure deterministic behavior and reliable evaluation.
# - Robust Parsing: Implemented a fallback mechanism for CSV parsing to handle different delimiters and decimal formats without manual intervention.