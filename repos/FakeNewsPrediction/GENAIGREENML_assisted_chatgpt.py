# Generated by generate_llm_code.py
# LLM: chatgpt
# Mode: assisted

import pandas as pd
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.linear_model import LogisticRegression
from sklearn.model_selection import train_test_split


def train_and_evaluate(fake_path: str = "Fake.csv", true_path: str = "True.csv") -> float:
    usecols = ["text"]

    df_fake = pd.read_csv(fake_path, usecols=usecols)
    df_real = pd.read_csv(true_path, usecols=usecols)

    df_fake["label"] = 0
    df_real["label"] = 1

    df = pd.concat([df_fake, df_real], axis=0, ignore_index=True, copy=False)
    X = df["text"]
    y = df["label"]

    X_train, X_test, y_train, y_test = train_test_split(
        X,
        y,
        test_size=0.2,
        random_state=42,
        stratify=y,
    )

    vectorizer = TfidfVectorizer(stop_words="english", max_df=0.7)
    X_train_tfidf = vectorizer.fit_transform(X_train)
    X_test_tfidf = vectorizer.transform(X_test)

    model = LogisticRegression(solver="liblinear", max_iter=200, random_state=42)
    model.fit(X_train_tfidf, y_train)

    accuracy = model.score(X_test_tfidf, y_test)
    return float(accuracy)


def main() -> None:
    accuracy = train_and_evaluate()
    print(f"ACCURACY={accuracy:.6f}")


if __name__ == "__main__":
    main()

# OPTIMIZATION SUMMARY
# - Loaded only required column(s) via usecols to reduce IO, memory footprint, and parsing overhead.
# - Concatenated with ignore_index=True and copy=False to minimize data movement and avoid unnecessary index work.
# - Avoided creating an extra trimmed DataFrame (df[['text','label']]) by building X/y directly from needed columns.
# - Added random_state and stratify to train_test_split for reproducibility and stable results (fewer reruns/energy).
# - Reused a single fitted TF-IDF vectorizer and only transformed test data (no redundant fitting).
# - Set LogisticRegression solver to 'liblinear' for efficient sparse binary classification and bounded iterations with max_iter.
# - Removed model/vectorizer persistence (joblib) to eliminate extra disk IO and serialization overhead.