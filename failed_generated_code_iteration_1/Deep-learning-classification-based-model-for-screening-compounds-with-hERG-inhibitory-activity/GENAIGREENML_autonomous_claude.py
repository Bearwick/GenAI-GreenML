# Generated by generate_llm_code.py
# LLM: claude
# Mode: autonomous

import pandas as pd
import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler, LabelEncoder
from sklearn.linear_model import LogisticRegression
from sklearn.pipeline import Pipeline
from sklearn.metrics import accuracy_score
import warnings
warnings.filterwarnings("ignore")

def robust_read_csv(path):
    try:
        df = pd.read_csv(path)
        if df.shape[1] < 2:
            df = pd.read_csv(path, sep=';', decimal=',')
        return df
    except Exception:
        try:
            df = pd.read_csv(path, sep=';', decimal=',')
            return df
        except Exception:
            return pd.DataFrame()

train_path = "herg_train_activity.csv"
test_path = "herg_test_activity.csv"

have_separate_test = False

try:
    train_df = robust_read_csv(train_path)
    test_df = robust_read_csv(test_path)
    if not test_df.empty and test_df.shape[0] > 0:
        have_separate_test = True
except Exception:
    train_df = pd.DataFrame()
    test_df = pd.DataFrame()

if train_df.empty:
    try:
        train_df = robust_read_csv("herg_train_activity.csv")
    except Exception:
        pass

if train_df.empty:
    try:
        import glob
        csv_files = glob.glob("*.csv")
        for f in csv_files:
            if "cas" not in f.lower():
                candidate = robust_read_csv(f)
                if not candidate.empty and candidate.shape[0] > 5:
                    train_df = candidate
                    break
    except Exception:
        pass

assert not train_df.empty, "No data loaded"

train_df.columns = train_df.columns.str.strip().str.replace(r'\s+', ' ', regex=True)
unnamed_cols = [c for c in train_df.columns if c.lower().startswith('unnamed')]
train_df = train_df.drop(columns=unnamed_cols, errors='ignore')

if have_separate_test and not test_df.empty:
    test_df.columns = test_df.columns.str.strip().str.replace(r'\s+', ' ', regex=True)
    unnamed_cols_test = [c for c in test_df.columns if c.lower().startswith('unnamed')]
    test_df = test_df.drop(columns=unnamed_cols_test, errors='ignore')

expected_headers = ['a_acc', 'a_don', 'b_rotN', 'density', 'logP(o/w)', 'logS', 'rings', 'Weight', 'Activity_value']

target_col = None
for col in train_df.columns:
    if col.lower().replace(' ', '_') == 'activity_value' or col == 'Activity_value':
        target_col = col
        break

if target_col is None:
    for col in train_df.columns:
        if 'activity' in col.lower() or 'target' in col.lower() or 'label' in col.lower() or 'class' in col.lower():
            target_col = col
            break

if target_col is None:
    numeric_cols = train_df.select_dtypes(include=[np.number]).columns.tolist()
    if numeric_cols:
        for col in numeric_cols:
            nunique = train_df[col].nunique()
            if 2 <= nunique <= 20:
                target_col = col
                break
        if target_col is None:
            target_col = numeric_cols[-1]

assert target_col is not None, "No suitable target column found"

for col in train_df.columns:
    if train_df[col].dtype == object:
        try:
            train_df[col] = pd.to_numeric(train_df[col], errors='co